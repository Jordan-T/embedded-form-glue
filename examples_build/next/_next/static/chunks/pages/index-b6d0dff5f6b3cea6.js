(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{3647:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,n(7310);var r,o=(r=n(4908))&&r.__esModule?r:{default:r};function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var s=new(function(){var t,e;function n(){return(!function(t,e){if(!(t instanceof e))throw TypeError("Cannot call a class as a function")}(this,n),n.instance)?n.instance:(n.instance=this,this._name="Krypton Glue",this.configuration={},this.domain=null,this.formToken=null,this.publicKey=null,this.loaded=!1,this.loading=!1,this)}return t=[{key:"loadLibrary",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return this.loaded?this.getKrypton(e):t?e?/^(?:http(s)?:\/\/)[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=.]+$/g.test(t)?/^\d{2,8}:(|test)publickey_.+$/g.test(e)?(this.domain=t,this.publicKey=e,this.formToken=n,this.domain&&this.publicKey)?this.loadKryptonClient():Promise.reject("The library cannot be loaded"):(console.error("Public key format should be shopId:[test]publickey_*"),Promise.reject("[".concat(e,"] is not a valid public key"))):(console.error("Domain format should be https://domain.name"),Promise.reject("[".concat(t,"] is not a valid endpoint domain"))):Promise.reject("Public key not defined"):Promise.reject("Domain not defined")}},{key:"loadKryptonClient",value:function(){var t=this;if(!this.loading){var e=this.publicKey,n=this.domain;this.loading=!0;var r=document.createElement("script");r.type="text/javascript",/^.+\/$/.test(n)||(n+="/"),r.src="".concat(n,"static/js/krypton-client/V4.0/stable/kr-payment-form.min.js"),r.setAttribute("kr-public-key",e),r.setAttribute("kr-spa-mode","true"),this.formToken&&r.setAttribute("kr-form-token",this.formToken),!document.querySelector('script[src="'.concat(r.src,'"]'))&&document.body?document.body.appendChild(r):document.body||console.warn("document.body is undefined")}return new Promise(function(e){(0,o.default)(window,"KR",function(){(0,o.default)(window.KR,"ready",function(){t.loaded=!0,t.loading=!1,e({KR:window.KR})})})})}},{key:"getKrypton",value:function(t){var e=this;return new Promise(function(n,r){t&&t!==e.publicKey?window.KR.setFormConfig({publicKey:t}).then(n).catch(r):n({KR:window.KR})})}}],i(n.prototype,t),e&&i(n,e),Object.defineProperty(n,"prototype",{writable:!1}),n}());e.default=s},5911:function(t,e,n){"use strict";e.Z=void 0;var r,o=((r=n(3647))&&r.__esModule?r:{default:r}).default;e.Z=o},4908:function(t,e){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.default=function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:150;setTimeout(function o(){t[e]?n():setTimeout(o,r)},0)}},7310:function(t,e,n){"use strict";t.exports=n(2702).polyfill()},2702:function(t,e,n){var r=n(3454);t.exports=function(){"use strict";function t(t){return"function"==typeof t}var e,o,i,s,u=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=0,a=void 0,l=void 0,f=function(t,e){_[c]=t,_[c+1]=e,2===(c+=2)&&(l?l(b):w())},h="undefined"!=typeof window?window:void 0,d=h||{},p=d.MutationObserver||d.WebKitMutationObserver,v="undefined"==typeof self&&void 0!==r&&"[object process]"===({}).toString.call(r),y="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel;function m(){var t=setTimeout;return function(){return t(b,1)}}var _=Array(1e3);function b(){for(var t=0;t<c;t+=2)(0,_[t])(_[t+1]),_[t]=void 0,_[t+1]=void 0;c=0}var w=void 0;function g(t,e){var n=this,r=new this.constructor(E);void 0===r[j]&&F(r);var o=n._state;if(o){var i=arguments[o-1];f(function(){return S(o,r,i,n._result)})}else O(n,r,t,e);return r}function T(t){if(t&&"object"==typeof t&&t.constructor===this)return t;var e=new this(E);return P(e,t),e}v?w=function(){return r.nextTick(b)}:p?(e=0,o=new p(b),i=document.createTextNode(""),o.observe(i,{characterData:!0}),w=function(){i.data=e=++e%2}):y?((s=new MessageChannel).port1.onmessage=b,w=function(){return s.port2.postMessage(0)}):w=void 0===h?function(){try{var t=Function("return this")().require("vertx");return a=t.runOnLoop||t.runOnContext,void 0!==a?function(){a(b)}:m()}catch(t){return m()}}():m();var j=Math.random().toString(36).substring(2);function E(){}var k=void 0;function x(e,n,r){n.constructor===e.constructor&&r===g&&n.constructor.resolve===T?1===n._state?C(e,n._result):2===n._state?N(e,n._result):O(n,void 0,function(t){return P(e,t)},function(t){return N(e,t)}):void 0===r?C(e,n):t(r)?f(function(t){var e=!1,o=function(t,e,n,r){try{t.call(e,n,r)}catch(t){return t}}(r,n,function(r){e||(e=!0,n!==r?P(t,r):C(t,r))},function(n){e||(e=!0,N(t,n))},"Settle: "+(t._label||" unknown promise"));!e&&o&&(e=!0,N(t,o))},e):C(e,n)}function P(t,e){if(t===e)N(t,TypeError("You cannot resolve a promise with itself"));else if(n=typeof e,null!==e&&("object"===n||"function"===n)){var n,r=void 0;try{r=e.then}catch(e){N(t,e);return}x(t,e,r)}else C(t,e)}function A(t){t._onerror&&t._onerror(t._result),K(t)}function C(t,e){t._state===k&&(t._result=e,t._state=1,0!==t._subscribers.length&&f(K,t))}function N(t,e){t._state===k&&(t._state=2,t._result=e,f(A,t))}function O(t,e,n,r){var o=t._subscribers,i=o.length;t._onerror=null,o[i]=e,o[i+1]=n,o[i+2]=r,0===i&&t._state&&f(K,t)}function K(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r=void 0,o=void 0,i=t._result,s=0;s<e.length;s+=3)r=e[s],o=e[s+n],r?S(n,r,o,i):o(i);t._subscribers.length=0}}function S(e,n,r,o){var i=t(r),s=void 0,u=void 0,c=!0;if(i){try{s=r(o)}catch(t){c=!1,u=t}if(n===s){N(n,TypeError("A promises callback cannot return that same promise."));return}}else s=o;n._state!==k||(i&&c?P(n,s):!1===c?N(n,u):1===e?C(n,s):2===e&&N(n,s))}var M=0;function F(t){t[j]=M++,t._state=void 0,t._result=void 0,t._subscribers=[]}var L=function(){function t(t,e){this._instanceConstructor=t,this.promise=new t(E),this.promise[j]||F(this.promise),u(e)?(this.length=e.length,this._remaining=e.length,this._result=Array(this.length),0===this.length?C(this.promise,this._result):(this.length=this.length||0,this._enumerate(e),0===this._remaining&&C(this.promise,this._result))):N(this.promise,Error("Array Methods must be provided an Array"))}return t.prototype._enumerate=function(t){for(var e=0;this._state===k&&e<t.length;e++)this._eachEntry(t[e],e)},t.prototype._eachEntry=function(t,e){var n=this._instanceConstructor,r=n.resolve;if(r===T){var o=void 0,i=void 0,s=!1;try{o=t.then}catch(t){s=!0,i=t}if(o===g&&t._state!==k)this._settledAt(t._state,e,t._result);else if("function"!=typeof o)this._remaining--,this._result[e]=t;else if(n===D){var u=new n(E);s?N(u,i):x(u,t,o),this._willSettleAt(u,e)}else this._willSettleAt(new n(function(e){return e(t)}),e)}else this._willSettleAt(r(t),e)},t.prototype._settledAt=function(t,e,n){var r=this.promise;r._state===k&&(this._remaining--,2===t?N(r,n):this._result[e]=n),0===this._remaining&&C(r,this._result)},t.prototype._willSettleAt=function(t,e){var n=this;O(t,void 0,function(t){return n._settledAt(1,e,t)},function(t){return n._settledAt(2,e,t)})},t}(),D=function(){function e(t){this[j]=M++,this._result=this._state=void 0,this._subscribers=[],E!==t&&("function"!=typeof t&&function(){throw TypeError("You must pass a resolver function as the first argument to the promise constructor")}(),this instanceof e?function(t,e){try{e(function(e){P(t,e)},function(e){N(t,e)})}catch(e){N(t,e)}}(this,t):function(){throw TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}())}return e.prototype.catch=function(t){return this.then(null,t)},e.prototype.finally=function(e){var n=this.constructor;return t(e)?this.then(function(t){return n.resolve(e()).then(function(){return t})},function(t){return n.resolve(e()).then(function(){throw t})}):this.then(e,e)},e}();return D.prototype.then=g,D.all=function(t){return new L(this,t).promise},D.race=function(t){var e=this;return new e(u(t)?function(n,r){for(var o=t.length,i=0;i<o;i++)e.resolve(t[i]).then(n,r)}:function(t,e){return e(TypeError("You must pass an array to race."))})},D.resolve=T,D.reject=function(t){var e=new this(E);return N(e,t),e},D._setScheduler=function(t){l=t},D._setAsap=function(t){f=t},D._asap=f,D.polyfill=function(){var t=void 0;if(void 0!==n.g)t=n.g;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(t){throw Error("polyfill failed because global object is unavailable in this environment")}var e=t.Promise;if(e){var r=null;try{r=Object.prototype.toString.call(e.resolve())}catch(t){}if("[object Promise]"===r&&!e.cast)return}t.Promise=D},D.Promise=D,D}()},3454:function(t,e,n){"use strict";var r,o;t.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(o=n.g.process)?void 0:o.env)?n.g.process:n(7663)},5557:function(t,e,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return n(6616)}])},6616:function(t,e,n){"use strict";n.r(e),n.d(e,{default:function(){return l}});var r=n(5893),o=n(9008),i=n.n(o),s=n(5911),u=n(7294),c=n(4298),a=n.n(c);function l(){let[t,e]=(0,u.useState)("");return(0,u.useEffect)(()=>{(async function(){let t="DEMO-TOKEN-TO-BE-REPLACED";try{let n=await fetch("http://localhost:3000/createPayment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({paymentConf:{amount:1e4,currency:"USD"}})});t=await n.text();let{KR:r}=await s.Z.loadLibrary("~~CHANGE_ME_ENDPOINT~~","~~CHANGE_ME_PUBLIC_KEY~~");await r.setFormConfig({formToken:t,"kr-language":"en-US"}),await r.onSubmit(async t=>{let n=await fetch("http://localhost:3000/validatePayment",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});return 200===n.status&&e("Payment successful!"),!1});let{result:o}=await r.attachForm("#myPaymentForm");await r.showForm(o.formId)}catch(t){e(t+" (see console for more details)")}})()},[]),(0,r.jsxs)("div",{children:[(0,r.jsxs)(i(),{children:[(0,r.jsx)("title",{children:"NextJS"}),(0,r.jsx)("meta",{name:"viewport",content:"initial-scale=1.0, width=device-width"}),(0,r.jsx)("link",{rel:"stylesheet",href:"~~CHANGE_ME_ENDPOINT~~/static/js/krypton-client/V4.0/ext/neon-reset.css"})]}),(0,r.jsx)(a(),{src:"~~CHANGE_ME_ENDPOINT~~/static/js/krypton-client/V4.0/ext/neon.js"}),(0,r.jsxs)("div",{className:"container",children:[(0,r.jsx)("h1",{children:"NextJS + KR.attachForm"}),(0,r.jsx)("div",{id:"myPaymentForm",children:(0,r.jsx)("div",{className:"kr-smart-form","kr-card-form-expanded":"true"})}),(0,r.jsx)("div",{"data-test":"payment-message",children:t})]})]})}},7663:function(t){!function(){var e={229:function(t){var e,n,r,o=t.exports={};function i(){throw Error("setTimeout has not been defined")}function s(){throw Error("clearTimeout has not been defined")}function u(t){if(e===setTimeout)return setTimeout(t,0);if((e===i||!e)&&setTimeout)return e=setTimeout,setTimeout(t,0);try{return e(t,0)}catch(n){try{return e.call(null,t,0)}catch(n){return e.call(this,t,0)}}}!function(){try{e="function"==typeof setTimeout?setTimeout:i}catch(t){e=i}try{n="function"==typeof clearTimeout?clearTimeout:s}catch(t){n=s}}();var c=[],a=!1,l=-1;function f(){a&&r&&(a=!1,r.length?c=r.concat(c):l=-1,c.length&&h())}function h(){if(!a){var t=u(f);a=!0;for(var e=c.length;e;){for(r=c,c=[];++l<e;)r&&r[l].run();l=-1,e=c.length}r=null,a=!1,function(t){if(n===clearTimeout)return clearTimeout(t);if((n===s||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(t);try{n(t)}catch(e){try{return n.call(null,t)}catch(e){return n.call(this,t)}}}(t)}}function d(t,e){this.fun=t,this.array=e}function p(){}o.nextTick=function(t){var e=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new d(t,e)),1!==c.length||a||u(h)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=p,o.addListener=p,o.once=p,o.off=p,o.removeListener=p,o.removeAllListeners=p,o.emit=p,o.prependListener=p,o.prependOnceListener=p,o.listeners=function(t){return[]},o.binding=function(t){throw Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(t){throw Error("process.chdir is not supported")},o.umask=function(){return 0}}},n={};function r(t){var o=n[t];if(void 0!==o)return o.exports;var i=n[t]={exports:{}},s=!0;try{e[t](i,i.exports,r),s=!1}finally{s&&delete n[t]}return i.exports}r.ab="//";var o=r(229);t.exports=o}()},9008:function(t,e,n){t.exports=n(2636)},4298:function(t,e,n){t.exports=n(5442)}},function(t){t.O(0,[774,888,179],function(){return t(t.s=5557)}),_N_E=t.O()}]);