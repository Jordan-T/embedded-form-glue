(()=>{"use strict";const t=function(t,e,n){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:150,o=function o(){t[e]?n():setTimeout(o,i)};setTimeout(o,0)};function e(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}const n=new(function(){function n(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,n),n.instance?n.instance:(n.instance=this,this._name="Krypton Glue",this.configuration={},this.domain=null,this.formToken=null,this.publicKey=null,this.loaded=!1,this.loading=!1,this)}var i,o;return i=n,o=[{key:"loadLibrary",value:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=/^(?:http(s)?:\/\/)[\w.-]+(?:\.[\w.-]+)+[\w\-._~:/?#[\]@!$&'()*+,;=.]+$/g,o=/^\d{2,8}:(|test)publickey_.+$/g;return this.loaded?this.getKrypton(e):t?e?i.test(t)?o.test(e)?(this.domain=t,this.publicKey=e,this.formToken=n,this.domain&&this.publicKey?this.loadKryptonClient():Promise.reject("The library cannot be loaded")):(console.error("Public key format should be shopId:[test]publickey_*"),Promise.reject("[".concat(e,"] is not a valid public key"))):(console.error("Domain format should be https://domain.name"),Promise.reject("[".concat(t,"] is not a valid endpoint domain"))):Promise.reject("Public key not defined"):Promise.reject("Domain not defined")}},{key:"loadKryptonClient",value:function(){var e=this;if(!this.loading){var n=this.publicKey,i=this.domain;this.loading=!0;var o=document.createElement("script");o.type="text/javascript",/^.+\/$/.test(i)||(i+="/"),o.src="".concat(i,"static/js/krypton-client/V4.0/stable/kr-payment-form.min.js"),o.setAttribute("kr-public-key",n),o.setAttribute("kr-spa-mode","true"),this.formToken&&o.setAttribute("kr-form-token",this.formToken),!document.querySelector('script[src="'.concat(o.src,'"]'))&&document.body?document.body.appendChild(o):document.body||console.warn("document.body is undefined")}return new Promise((function(n){t(window,"KR",(function(){t(window.KR,"ready",(function(){e.loaded=!0,e.loading=!1,n({KR:window.KR})}))}))}))}},{key:"getKrypton",value:function(t){var e=this;return new Promise((function(n,i){t&&t!==e.publicKey?window.KR.setFormConfig({publicKey:t}).then(n).catch(i):n({KR:window.KR})}))}}],o&&e(i.prototype,o),Object.defineProperty(i,"prototype",{writable:!1}),n}());"undefined"!=typeof window&&(window.KRGlue||(window.KRGlue=n))})();
//# sourceMappingURL=kr-payment-form-glue.min.js.map